# Analytics_Engineering_Final_Project
–ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π –¥–∞—à–±–æ—Ä–¥ –º–∞–∫—Ä–æ–µ–∫–æ–Ω–æ–º—ñ–∫–∏ –£–∫—Ä–∞—ó–Ω–∏ ‚Äî ETL —á–µ—Ä–µ–∑ Airflow, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ dbt, –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –≤ Power BI.

_**‚Äú–ê–Ω–∞–ª—ñ–∑ –º–∞–∫—Ä–æ–µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏—Ö —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—Ç–æ—Ä–≥–æ–≤–µ–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –£–∫—Ä–∞—ó–Ω–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –∑–±–æ—Ä—É —ñ–∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –≤–µ–±-–¥–∂–µ—Ä–µ–ª‚Äù**_

**–¢–µ–º–∞:**

–í–∑–∞—î–º–æ–∑–≤‚Äô—è–∑–æ–∫ –º—ñ–∂ –∫–ª—é—á–æ–≤–∏–º–∏ –º–∞–∫—Ä–æ–µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏–º–∏ –ø–æ–∫–∞–∑–Ω–∏–∫–∞–º–∏ –£–∫—Ä–∞—ó–Ω–∏ ‚Äî –∫—É—Ä—Å–æ–º –≤–∞–ª—é—Ç (USD, EUR), —ñ–Ω—Ñ–ª—è—Ü—ñ—î—é, –æ–±–ª—ñ–∫–æ–≤–æ—é —Å—Ç–∞–≤–∫–æ—é –ù–ë–£, –µ–∫—Å–ø–æ—Ä—Ç–æ–º —Ç–∞ —ñ–º–ø–æ—Ä—Ç–æ–º.

**–û–ø–∏—Å –ø—Ä–æ–µ–∫—Ç—É:**

–ê–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏–π –¥–∞—à–±–æ—Ä–¥, –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –ù–ë–£ —Ç–∞ –î–µ—Ä–∂—Å—Ç–∞—Ç—É, –¥–æ–∑–≤–æ–ª—è—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∑–≤‚Äô—è–∑–∫–∏ –º—ñ–∂ –∫–ª—é—á–æ–≤–∏–º–∏ –º–∞–∫—Ä–æ–µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏–º–∏ –ø–æ–∫–∞–∑–Ω–∏–∫–∞–º–∏ –£–∫—Ä–∞—ó–Ω–∏ ‚Äî –∫—É—Ä—Å–∞–º–∏ –≤–∞–ª—é—Ç, –æ–±–ª—ñ–∫–æ–≤–æ—é —Å—Ç–∞–≤–∫–æ—é –ù–ë–£, —ñ–Ω—Ñ–ª—è—Ü—ñ—î—é —Ç–∞ –ø–æ–∫–∞–∑–Ω–∏–∫–∞–º–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó —Ç–æ—Ä–≥—ñ–≤–ª—ñ.  
–ü—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –Ω–∞ –±–∞–∑—ñ Apache Airflow, dbt, PostgreSQL —Ç–∞ Power BI, —ñ–∑ –≥–Ω—É—á–∫–æ—é –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—î—é —ñ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–æ—é —Ç–∏–ø—É Medallion.

**–¶—ñ–ª—ñ –ø—Ä–æ—î–∫—Ç—É:**

1.	–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö: –ó—ñ–±—Ä–∞—Ç–∏ —â–æ–¥–µ–Ω–Ω—ñ/—â–æ–º—ñ—Å—è—á–Ω—ñ –º–∞–∫—Ä–æ–µ–∫–æ–Ω–æ–º—ñ—á–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∑ —á–æ—Ç–∏—Ä—å–æ—Ö –¥–∂–µ—Ä–µ–ª (–≤–∞–ª—é—Ç–Ω—ñ –∫—É—Ä—Å–∏, —ñ–Ω—Ñ–ª—è—Ü—ñ—è, –æ–±–ª—ñ–∫–æ–≤–∞ —Å—Ç–∞–≤–∫–∞ –ù–ë–£, –∑–æ–≤–Ω—ñ—à–Ω—è —Ç–æ—Ä–≥—ñ–≤–ª—è) –≤ —î–¥–∏–Ω—É –º–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.
2.	–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω—É: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–∞–π–ø–ª–∞–π–Ω —É —Å—Ç–∏–ª—ñ Medallion Architecture (Bronze ‚Üí Silver ‚Üí Gold).
3.	–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—ñ–≤: –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –µ—Ç–∞–ø—ñ–≤ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∞—É–¥–∏—Ç—É —Ç–∞ —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ.
4.	–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ç–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ ETL-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—é –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —ñ –≥–Ω—É—á–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–æ–¥–µ–ª—è–º–∏.
5.	–ü–æ–±—É–¥—É–≤–∞—Ç–∏ –∑—Ä—É—á–Ω—ñ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó.
   
**–î–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö.**

| ‚Ññ  | –ù–∞–∑–≤–∞ –¥–∂–µ—Ä–µ–ª–∞                          | –î–∂–µ—Ä–µ–ª–æ / URL                                  | –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö                      | –ß–∞—Å—Ç–æ—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è   | –¢–∞–±–ª–∏—Ü—è / –æ–±'—î–∫—Ç                      | –ö–æ–º–µ–Ω—Ç–∞—Ä / –ü—Ä–∏–º—ñ—Ç–∫–∏                                                                 |
|----|----------------------------------------|------------------------------------------------|-----------------------------------|---------------------|----------------------------------------|-------------------------------------------------------------------------------------|
| 1  | –ö—É—Ä—Å –≤–∞–ª—é—Ç (USD, EUR)                  | bank.gov.ua API                                | JSON: cc, txt, rate, date         | –©–æ–¥–µ–Ω–Ω–æ              | `fin_proj.t1_raw_exch_rates`           | –ê–≤—Ç–æ–∑–∞–ø–∏—Ç –¥–æ API, –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–∞—Ç–∏, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è–º                        |
| 2  | –Ü–Ω–¥–µ–∫—Å —ñ–Ω—Ñ–ª—è—Ü—ñ—ó                        | minfin.com.ua                                  | HTML-—Ç–∞–±–ª–∏—Ü—è: —Ä—ñ–∫ + –º—ñ—Å—è—Ü—ñ        | –©–æ–º—ñ—Å—è—á–Ω–æ            | `fin_proj.t2_raw_inflation_index`      | –ú–∞–ø—ñ–Ω–≥ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö –º—ñ—Å—è—Ü—ñ–≤, –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–Ω–∞—á–µ–Ω—å              |
| 3  | –û–±–ª—ñ–∫–æ–≤–∞ —Å—Ç–∞–≤–∫–∞ –ù–ë–£                    | minfin.com.ua                                  | HTML-—Ç–∞–±–ª–∏—Ü—è: –ø–µ—Ä—ñ–æ–¥, % —Å—Ç–∞–≤–∫–∞    | –ó–≥—ñ–¥–Ω–æ –∑–º—ñ–Ω –ù–ë–£      | `fin_proj.t3_raw_nbu_rate`             | –ó —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–º—ñ–Ω —Ñ–æ—Ä–º—É—î—Ç—å—Å—è daily-–∫–∞–ª–µ–Ω–¥–∞—Ä, —Å—Ç–∞–≤–∫–∞ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î—Ç—å—Å—è –≤ %, `merge_asof` |
| 4  | –ó–æ–≤–Ω—ñ—à–Ω—è —Ç–æ—Ä–≥—ñ–≤–ª—è (–µ–∫—Å–ø–æ—Ä—Ç / —ñ–º–ø–æ—Ä—Ç)   | Excel-—Ñ–∞–π–ª–∏ –∑ ukrstat.gov.ua                   | `.xls` / `.xlsx`, —Ç–∞–±–ª–∏—á–Ω—ñ –¥–∞–Ω—ñ   | –©–æ–º—ñ—Å—è—á–Ω–æ            | `fin_proj.t4_raw_ukrstat_trade_data`   | –ê—Ä—Ö—ñ–≤–Ω—ñ —Ñ–∞–π–ª–∏ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Ä–æ–∫—É, –ø–∞—Ä—Å–∏–Ω–≥ –ø–µ—Ä—ñ–æ–¥—É, —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ —Ç–æ–≤–∞—Ä–Ω–∏–º–∏ –ø–æ–∑–∏—Ü—ñ—è–º–∏    |
| 5  | –î–æ–≤—ñ–¥–Ω–∏–∫ —Ç–æ–≤–∞—Ä–Ω–∏—Ö –≥—Ä—É–ø                 | Excel-—Ñ–∞–π–ª–∏ –∑ ukrstat.gov.ua                   | `.xls` / `.xlsx`, –¥–æ–≤—ñ–¥–Ω–∏–∫–∏       | –©–æ—Ä–æ–∫—É               | `fin_proj.t5_raw_ukrstat_trade_dict`   | –í–∏—Ç—è–≥ –≥—Ä—É–ø–æ–≤–∏—Ö –Ω–∞–∑–≤, —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è ENG-–≤–µ—Ä—Å—ñ–π –Ω–∞–∑–≤, –æ—á–∏—Å—Ç–∫–∞ –ø–æ —Ä–æ–∫—É                    |
| 6  | –°–ø–∏—Å–æ–∫ –∫—Ä–∞—ó–Ω –¥–ª—è –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ—ó –∫–∞—Ä—Ç–∏    | OpenStreetMap                                  | CSV: –Ω–∞–∑–≤–∏ –∫—Ä–∞—ó–Ω, ISO-–∫–æ–¥–∏        | –û–Ω–æ–≤–ª—é—î—Ç—å—Å—è –≤—Ä—É—á–Ω—É   | CSV-—Ñ–∞–π–ª —É –ø–∞–ø—Ü—ñ `seed`                | –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ Power BI –¥–ª—è –≥–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –º–∞–ø—ñ–Ω–≥—É –µ–∫—Å–ø–æ—Ä—Ç/—ñ–º–ø–æ—Ä—Ç –∑–∞ –∫—Ä–∞—ó–Ω–∞–º–∏    |


**Medallion Architecture**

–¢—Ä–∏ —à–∞—Ä–∏ –¥–∞–Ω–∏—Ö, —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —á–µ—Ä–µ–∑ DAG-–∏ Airflow —ñ dbt-–º–æ–¥–µ–ª—ñ:

- üü´ **Bronze** ‚Äì —Å–∏—Ä—ñ –¥–∞–Ω—ñ –∑ API —Ç–∞ Excel: –∫—É—Ä—Å–∏ –≤–∞–ª—é—Ç, —ñ–Ω—Ñ–ª—è—Ü—ñ—è, —Ç–æ—Ä–≥—ñ–≤–ª—è, –¥–æ–≤—ñ–¥–Ω–∏–∫–∏
- ‚¨ú **Silver** ‚Äì –æ—á–∏—â–µ–Ω–Ω—è, –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è —Ñ–æ—Ä–º–∞—Ç—ñ–≤ —á–µ—Ä–µ–∑ dbt
- üü® **Gold** ‚Äì –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ –∑ –º–∞–∫—Ä–æ-–ø–æ–∫–∞–∑–Ω–∏–∫–∞–º–∏


**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**

```
  astro-finalproject/
‚îú‚îÄ‚îÄ dags/
‚îÇ   ‚îú‚îÄ‚îÄ d1_etl_exch_cur__trade_ukrstat_dag.py            # DAG: –∫—É—Ä—Å –≤–∞–ª—é—Ç + —Ç–æ—Ä–≥—ñ–≤–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ d2_inflation_nburate_dag.py                      # DAG: —ñ–Ω—Ñ–ª—è—Ü—ñ—è + —Å—Ç–∞–≤–∫–∞ –ù–ë–£
‚îÇ   ‚îú‚îÄ‚îÄ d3_ukrstat_trade_dict_dag.py                     # DAG: –¥–æ–≤—ñ–¥–Ω–∏–∫ —Ç–æ–≤–∞—Ä–Ω–∏—Ö –≥—Ä—É–ø
‚îÇ   ‚îú‚îÄ‚îÄ d4_dbt_ukrstat_dict_log_dag.py                   # DAG: –∑–∞–ø—É—Å–∫ dbt, –ª–æ–≥—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îî‚îÄ‚îÄ final_project/
‚îÇ       ‚îú‚îÄ‚îÄ models/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ukrstat_trade_data/                      # staging –º–æ–¥–µ–ª—ñ —Ç–æ—Ä–≥—ñ–≤–ª—ñ, –∫—É—Ä—Å—ñ–≤
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_ukrstat_trade_data_country.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_ukrstat_trade_data_product.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_exch_rates_median_month.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.yml
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ukrstat_trade_dict/                      # staging –º–æ–¥–µ–ª—ñ –¥–æ–≤—ñ–¥–Ω–∏–∫—ñ–≤
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_ukrstat_trade_dict_group.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stg_ukrstat_trade_dict_subgr.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.yml
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ marts/                                   # –∞–≥—Ä–µ–≥–æ–≤–∞–Ω—ñ –º–æ–¥–µ–ª—ñ (Gold)
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dim_ukrstat_trade_product_location.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dim_ukrstat_trade_summary.sql
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.yml
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ schema_country_dict.yml                  # –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π —Å–ª–æ–≤–Ω–∏–∫
‚îÇ       ‚îú‚îÄ‚îÄ seeds/                                       # seed-—Ñ–∞–π–ª–∏ –¥–ª—è –∫–∞—Ä—Ç —Ç–∞ –¥–æ–≤—ñ–¥–Ω–∏–∫—ñ–≤
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ country_dict.csv
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ country_dict_id.csv
‚îÇ       ‚îî‚îÄ‚îÄ dbt_project.yml                              # –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è dbt
```

**–õ–æ–≥—É–≤–∞–Ω–Ω—è ETL-–ø—Ä–æ—Ü–µ—Å—ñ–≤**

| –ü–æ–ª–µ             | –¢–∏–ø –¥–∞–Ω–∏—Ö   | –û–ø–∏—Å                                                                 |
|------------------|-------------|----------------------------------------------------------------------|
| `etl_date`       | `DATE`      | –î–∞—Ç–∞, –∑–∞ —è–∫—É –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –¥–∞–Ω—ñ (–ª–æ–≥—ñ—á–Ω–∞ –¥–∞—Ç–∞ –≤–∏–±—ñ—Ä–∫–∏)               |
| `source_name`    | `TEXT`      | –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö: `"currency"`, `"nbu_rate"`, `"ukrstat_dict"` —Ç–æ—â–æ    |
| `records_loaded` | `INT`       | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤                              |
| `status`         | `TEXT`      | –°—Ç–∞—Ç—É—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: `"SUCCESS"`, `"ERROR"`, `"WARNING"`               |
| `message`        | `TEXT`      | –¢–µ—Ö–Ω—ñ—á–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: `"API responded 200"` –∞–±–æ `"Timeout"`—Ç–æ—â–æ    |
| `runtime_seconds`| `FLOAT`     | –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ —É —Å–µ–∫—É–Ω–¥–∞—Ö                             |
| `executed_at`    | `TIMESTAMP` | –ß–∞—Å –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç–∞ (—Ñ—ñ–∫—Å—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —è–∫ `now()`)             |

–¢–∞–±–ª–∏—Ü—è –ª–æ–≥—ñ–≤ –¥–∞—î –∑–º–æ–≥—É:
‚Ä¢	–ö–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—ñ—Ö DAG-—ñ–≤
‚Ä¢	–í–∏—è–≤–ª—è—Ç–∏ –∑–±–æ—ó –∞–±–æ –ø—É—Å—Ç—ñ –¥–∞—Ç–∞—Å–µ—Ç–∏
‚Ä¢	–û—Ü—ñ–Ω–∏—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–∞–π–ø–ª–∞–π–Ω—É –ø–æ –¥–∂–µ—Ä–µ–ª–∞—Ö
–õ–æ–≥—É–≤–∞–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ Python-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä @log_to_postgres(...), —è–∫–∏–π –∑–∞–ø–∏—Å—É—î —Ü—ñ –¥–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ—Ç–∞–ø—É.
